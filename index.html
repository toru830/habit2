<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>習慣化アプリ v2.2</title>
    <meta name="description" content="週間習慣トラッカー">
    <meta name="theme-color" content="#000000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="習慣化">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="manifest" href="manifest.json">
    <!-- ファビコン - 習慣化アプリ用のカスタムアイコン -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="favicon.ico">
    <link rel="stylesheet" href="styles.css?v=20250923180000">
</head>
<body>
    <div class="app-container">
        <!-- メインコンテンツ -->
        <div class="main-content">
            <!-- ホームビュー -->
            <div class="view" id="homeView">
                <div class="header">
                    <h1>習慣化アプリ</h1>
                    <div class="header-actions">
                        <button class="icon-btn" id="settingsBtn" title="設定">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- 週間カレンダー -->
                <div class="week-calendar">
                    <div class="week-header">
                        <button class="nav-btn prev-week" id="prevWeekBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="15,18 9,12 15,6"></polyline>
                            </svg>
                        </button>
                        <h2 id="weekTitle">今週</h2>
                        <button class="nav-btn next-week" id="nextWeekBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="9,18 15,12 9,6"></polyline>
                            </svg>
                        </button>
                    </div>
                    <div class="week-grid" id="weekGrid">
                        <!-- 週間グリッドがここに動的に生成される -->
                    </div>
                </div>

                <!-- 習慣一覧 -->
                <div class="habits-section">
                    <h3>習慣一覧</h3>
                    <div class="habits-list" id="habitsList">
                        <!-- 習慣がここに動的に生成される -->
                    </div>
                    <button class="add-habit-btn" id="addHabitBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        新しい習慣を追加
                    </button>
                </div>
            </div>

            <!-- 設定ビュー -->
            <div class="view" id="settingsView" style="display: none;">
                <div class="header">
                    <button class="back-btn" id="backFromSettingsBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15,18 9,12 15,6"></polyline>
                        </svg>
                    </button>
                    <h1>設定</h1>
                </div>

                <div class="settings-content">
                    <div class="settings-section">
                        <h3>データ管理</h3>
                        <div class="setting-item">
                            <label for="exportData">データをエクスポート</label>
                            <button class="btn" id="exportDataBtn">エクスポート</button>
                        </div>
                        <div class="setting-item">
                            <label for="importData">データをインポート</label>
                            <input type="file" id="importDataInput" accept=".json" style="display: none;">
                            <button class="btn" id="importDataBtn">インポート</button>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>テーマ</h3>
                        <div class="setting-item">
                            <label for="themeSelect">テーマを選択</label>
                            <select id="themeSelect">
                                <option value="light">ライト</option>
                                <option value="dark">ダーク</option>
                                <option value="auto">自動</option>
                            </select>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>通知</h3>
                        <div class="setting-item">
                            <label for="notificationToggle">通知を有効にする</label>
                            <input type="checkbox" id="notificationToggle">
                        </div>
                    </div>
                </div>
            </div>

            <!-- バッジビュー -->
            <div class="view" id="badgeView" style="display: none;">
                <div class="header">
                    <button class="back-btn" id="backFromBadgeBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15,18 9,12 15,6"></polyline>
                        </svg>
                    </button>
                    <h1>バッジセンター</h1>
                </div>

                <div class="badge-view">
                    <!-- バッジギャラリー -->
                    <div class="badge-gallery-section">
                        <h3>バッジギャラリー</h3>
                        <div class="badge-gallery" id="badgeGallery">
                            <!-- バッジがここに動的に生成される -->
                        </div>
                    </div>

                    <!-- 獲得済みバッジ -->
                    <div class="owned-badges-section">
                        <h3>獲得済みバッジ</h3>
                        <div class="owned-badges" id="ownedBadges">
                            <!-- 獲得済みバッジがここに動的に生成される -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- モンスター図鑑ビュー -->
            <div class="view" id="monsterView" style="display: none;">
                <div class="header">
                    <button class="back-btn" id="backFromMonsterBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15,18 9,12 15,6"></polyline>
                        </svg>
                    </button>
                    <h1>モンスター図鑑</h1>
                </div>

                <div class="monster-content">
                    <div class="monster-grid" id="monsterGrid">
                        <!-- モンスターがここに動的に生成される -->
                    </div>
                </div>
            </div>

            <!-- 統計ビュー -->
            <div class="view" id="statsView" style="display: none;">
                <div class="header">
                    <button class="back-btn" id="backFromStatsBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15,18 9,12 15,6"></polyline>
                        </svg>
                    </button>
                    <h1>あなたの成果</h1>
                </div>

                <div class="stats-content">
                    <!-- 合計値推移グラフ -->
                    <div class="chart-section">
                        <h3>合計値の推移</h3>
                        <div class="chart-container">
                            <canvas id="totalChart" width="400" height="200"></canvas>
                        </div>
                        <div class="chart-summary">
                            <div class="summary-chip">
                                <div class="chip-label">30日累計</div>
                                <div class="chip-value" id="total30Days">0</div>
                            </div>
                            <div class="summary-chip">
                                <div class="chip-label">直近7日</div>
                                <div class="chip-value" id="total7Days">0</div>
                            </div>
                            <div class="summary-chip">
                                <div class="chip-label">1日平均</div>
                                <div class="chip-value" id="dailyAverage">0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ボトムナビゲーション -->
        <div class="bottom-nav">
            <button class="nav-btn active" id="homeBtn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9,22 9,12 15,12 15,22"></polyline>
                </svg>
                <span>ホーム</span>
            </button>
            <button class="nav-btn" id="badgeBtn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                </svg>
                <span>バッジ</span>
            </button>
            <button class="nav-btn" id="monsterBtn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                </svg>
                <span>モンスター</span>
            </button>
            <button class="nav-btn" id="statsBtn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 20V10"></path>
                    <path d="M12 20V4"></path>
                    <path d="M6 20v-6"></path>
                </svg>
                <span>統計</span>
            </button>
        </div>
    </div>

    <!-- 習慣追加モーダル -->
    <div class="modal" id="addHabitModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>新しい習慣を追加</h3>
                <button class="close-btn" id="closeAddHabitModal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="habitName">習慣名</label>
                    <input type="text" id="habitName" placeholder="例: 朝の散歩">
                </div>
                <div class="form-group">
                    <label for="habitColor">色</label>
                    <div class="color-picker">
                        <input type="color" id="habitColor" value="#4A90E2">
                    </div>
                </div>
                <div class="form-group">
                    <label for="habitIcon">アイコン</label>
                    <div class="icon-picker">
                        <button class="icon-option" data-icon="🏃">🏃</button>
                        <button class="icon-option" data-icon="📚">📚</button>
                        <button class="icon-option" data-icon="💧">💧</button>
                        <button class="icon-option" data-icon="🍎">🍎</button>
                        <button class="icon-option" data-icon="💤">💤</button>
                        <button class="icon-option" data-icon="🧘">🧘</button>
                        <button class="icon-option" data-icon="🎵">🎵</button>
                        <button class="icon-option" data-icon="✍️">✍️</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelAddHabit">キャンセル</button>
                <button class="btn btn-primary" id="saveHabit">保存</button>
            </div>
        </div>
    </div>

    <!-- 習慣編集モーダル -->
    <div class="modal" id="editHabitModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>習慣を編集</h3>
                <button class="close-btn" id="closeEditHabitModal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="editHabitName">習慣名</label>
                    <input type="text" id="editHabitName">
                </div>
                <div class="form-group">
                    <label for="editHabitColor">色</label>
                    <div class="color-picker">
                        <input type="color" id="editHabitColor">
                    </div>
                </div>
                <div class="form-group">
                    <label for="editHabitIcon">アイコン</label>
                    <div class="icon-picker">
                        <button class="icon-option" data-icon="🏃">🏃</button>
                        <button class="icon-option" data-icon="📚">📚</button>
                        <button class="icon-option" data-icon="💧">💧</button>
                        <button class="icon-option" data-icon="🍎">🍎</button>
                        <button class="icon-option" data-icon="💤">💤</button>
                        <button class="icon-option" data-icon="🧘">🧘</button>
                        <button class="icon-option" data-icon="🎵">🎵</button>
                        <button class="icon-option" data-icon="✍️">✍️</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="deleteHabit">削除</button>
                <button class="btn btn-secondary" id="cancelEditHabit">キャンセル</button>
                <button class="btn btn-primary" id="updateHabit">更新</button>
            </div>
        </div>
    </div>

    <!-- スクリプト -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js?v=20250923190000"></script>
</body>
</html>
